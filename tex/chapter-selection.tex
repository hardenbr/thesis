\chapter{Event Selection\label{ch:selection}}

This chapter discusses additional event-wide requirements imposed to further
improve the sensitivity of selecting the signal of interest over the background contributions
beyond that of the preselection requirements covered in Chapter~\ref{ch:objects}.
Event classification is covered in Section~\ref{sec:classification}, in which two classes of
events are defined for extracting signal separately.
Section~\ref{sec:higgsreconstruction} discusses how the photons and jets passing the preselection
requirements are assembled into Higgs candidates. For the resonant search $X\rightarrow HH$,
Section~\ref{sec:Xreconstruction} discusses how the two Higgs come together to construct a resonant
candidate. The construction of a data control
sample, discussed in Section~\ref{subsec:dataCS}, allows for the study of additional event-wide
requirements for improving sensitivity, discussed in Section~\ref{sec:extraction}.
Finally, with all the event requirements in place, two event displays in Section~\ref{sec:displays}
give a sense of what candidate events look like in the detector.

\section{Event Classification\label{sec:classification}}

B-tagging, presented in Section~\ref{subsec:btag}, is used at the preselection level by
requiring 1 CSVL b-tagged jet. To further improve the sensitivity, the working point used for
signal extraction is the medium one (CSVM), which corresponds to an efficiency of around 60--70\%
and a mistag rate 1--2\%, depending on the jet $p_{\rm T}$.
There is also a tight working point (CSVT) not used in this analysis,
which corresponds to a mistag rate of 0.1\%.
With the CSVM working point, events are classified into three categories for the resonant search
based on the number of CSVM b-tagged jets. Events with two or more b-tags, called high purity,
drive the sensitivity of the search. Events with one b-tag, called medium purity,
bring low contribution to the sensitivity
but allow for increased signal acceptance. Events without any b-tags,
called low purity, are used only for cross-checks and are rejected from the main analysis.
The preselection cuts and event categorization
are summarized in Table~\ref{table:gencut}.
For the nonresonant search, the high and medium purity categories will be further divided based
on the four-body mass spectrum, discussed in Section~\ref{subsec:add_discrimination}

\begin{table}[htbp!]
  \centering
  \renewcommand{\arraystretch}{1.4}
  \caption{Summary of the selection applied to photons and jets and the event classification
for the resonant search.}
  \input{tables/gencut}
  \label{table:gencut}
\end{table}

\section{Higgs Reconstruction\label{sec:higgsreconstruction}}

From the lists of photons and jets passing the identification and kinematic requirements, Higgs
candidates are constructed. When there are more than two photon or jet candidates, a choice
must be made as to which pair is consistent with the decay of a Higgs. When
choosing the diphoton candidate, the two photons with the highest $p_{\rm T}$ are chosen, since
jets faking photons tend to be softer than prompt photons.

When choosing the jets for the dijet candidate, four choices were considered after b-tagging:
\begin{itemize}
\item the two jets with the highest $p_{\rm T}$,
\item the pair of jets that maximizes $p_{{\rm T},jj}$,
\item the pair of jets that maximizes $\frac{p_{{\rm T},jj}}{\Mjj}$, and
\item the pair of jets that minimizes $|\Mjj-\Mgg|$.
\end{itemize}
In the high-purity category, the dijet candidate is selected from all b-tagged jets,
while in the medium-purity category, the candidate is selected from the pairing of the b-tagged jet
with one of the non-tagged jets.
The criterion used for this selection is to take the pair that maximizes $p_{{\rm T},jj}$. 
This choice selects the correct jets roughly 87\% of the time, without producing any local peaking
structure in the background. For the resonant search
in the high-purity (medium-purity) category, the resolution, defined as the full-width at half-maximum,
decreases from 40 (50) GeV to 30 (30) GeV as the resonance mass increases from 300 GeV to 1 TeV.
This is also shown visually in Figure~\ref{fig:mjj_onlyhiggs}.

\section{Resonance Reconstruction and Kinematic Fit\label{sec:Xreconstruction}}

For the resonant search, the double Higgs system is constructed
by combining the $\Hgg$ and $\Hbb$ candidates. (This is also used in the nonresonant search
where the resulting mass distribution does not correspond to a local peak.)
In order to improve the resolution on the $\Mggjj$ distribution, an additional constraint
is applied on the two selected jets.
This constraint, called the kinematic fit~\cite{Chatrchyan:2013yoa},
is performed by varying the four-momentum of each jet with respect to its energy and position
resolutions in order to fix the dijet mass to the Higgs mass, i.e., $\Mjj = 125$~GeV.
The resulting distribution is denoted as $\Mggjjk$. Distributions before (\Mggjj) and after (\Mggjjk)
the kinematic fit
are shown in Figure~\ref{fig:mggjj_onlyhiggs} for the resonant signal and resonant backgrounds
and in Figure~\ref{fig:mggjj_controlplot} for data and the sum of backgrounds.

\begin{figure}[htbp!]
 \begin{center}
   \includegraphics[width=0.70\textwidth]{figures/selection/TotalMass_OnlyHiggs.pdf}
   \includegraphics[width=0.70\textwidth]{figures/selection/TotalMassKinFit_OnlyHiggs.pdf}
 \end{center}
\caption{Simulated four-body mass spectrum for the resonant signal and the sum of all production
mechanisms of the
SM Higgs boson after basic selections on photons and jets and requesting at least
one loose b-tagged jet. Before (after) the kinematic fit is shown in the top (bottom) figure.
The spectra are normalized to one.}
\label{fig:mggjj_onlyhiggs}
\end{figure}

\begin{figure}[htbp!]
 \begin{center}
   \includegraphics[width=0.45\textwidth]{figures/selection/TotalMass_ShapeNormalized_sys.pdf}
   \includegraphics[width=0.45\textwidth]{figures/selection/TotalMassKinFit_ShapeNormalized_sys.pdf}
   \includegraphics[width=0.45\textwidth]{figures/selection/TotalMass_ShapeNormalized_Log_sys.pdf}
   \includegraphics[width=0.45\textwidth]{figures/selection/TotalMassKinFit_ShapeNormalized_Log_sys.pdf}
 \end{center}
\caption{Control plots for the four-body mass spectrum after basic photon and jet selections
and requiring at least one loose b-tagged jet. The simulation is normalized to data and
the statistical uncertainty on the number of simulated events is shown in dashed overlay.
The left (right) figures are before (after) the kinematic fit is imposed, and
the top (bottom) figures are shown in linear (log) scale.}
\label{fig:mggjj_controlplot}
\end{figure}

\section{Further Optimization\label{sec:extraction}}

The strategy for extracting a measurement of the signal yield centers on the fact that there
are three spectra, $\Mgg$, $\Mjj$, and $\Mggjjk$, from which an excess can be measured.
For the resonant search, an excess would appear as a localized bump on the
$\Mggjjk$ spectrum giving a direct handle on $m_X$,
but, recalling from Figure~\ref{fig:mggjj_controlplot}, there is a kinematic peak in the background
around 300 GeV. In order to avoid looking for a peak on top of a peak, the resonant search is
divided into two regimes:
\begin{itemize}
\item the high-mass analysis searches for an excess on the $\Mggjjk$ spectrum for $m_X \ge 400$~GeV, and
\item the low-mass analysis searches for an excess on the $\Mgg$ spectrum for $m_X \in [260, 400]$~GeV.
\end{itemize}
In both cases, there is more discrimination to be gained by imposing requirements on the two spectra
not being fit, as is described in Section~\ref{subsec:add_discrimination}.

The nonresonant search can be viewed as a special case of the low-mass resonant search in which
the $\Mggjjk$ spectrum has no local peak. Here, excess is sought on the $\Mgg \times \Mjj$ plane,
with additional requirements imposed on $\Mggjj$ and the angle between the two Higgs candidates
$\acosthetastar$.

\subsection{Data Control Sample\label{subsec:dataCS}}

For optimizing the kinematic cuts imposed after preselection, a data control sample is constructed.
The events for the sample are selected with the same preselection as data except for
the inversion of one of the photon's identification and isolation requirements, giving a sample
dominated by the contribution of $\gjjj$ rather than the $\ggjj$ of the signal region.

The main kinematic variables related to the photons have a different shape
between the control sample and the
signal region, so reweighting of the control sample is needed to ensure that the distributions
match those in the signal region. The event weights are derived by matching the shape
of the control sample to data in the $p_{{\rm T},\gamma_1} \times p_{{\rm T},\gamma_1}$ plane,
with a veto in signal region on the range $\Mgg \in [115, 135]$~GeV. Afterwards,
the normalization of the control sample is fixed to the normalization of the signal
region. Figure~\ref{fig:datacs}
shows the effect of the reweighting on the three spectra of interest.

\begin{figure}[htbp!]
 \begin{center}
   \includegraphics[width=0.45\textwidth]{figures/selection/mggSpectrum-log.pdf}
   \includegraphics[width=0.45\textwidth]{figures/selection/mjjSpectrum-log.pdf}
   \includegraphics[width=0.45\textwidth]{figures/selection/mradSpectrum-log.pdf}
 \end{center}
\caption{Effect of reweighting the $\gjjj$ control sample
to match the kinematic distributions of the
signal region. Double $\gamma$ refers to the signal region, with a veto in $\Mgg$ or $\Mjj$
on a range about the Higgs mass. Single $\gamma$
refers to the $\gjjj$ sample before the weighting, and Single $\gamma$ corr. refers to the reweighted
$\gjjj$ sample. The shape of the reweighted $\gjjj$ sample is reasonably consistent with that of data
for all three spectra.}
\label{fig:datacs}
\end{figure}

\subsection{Additional Discrimination\label{subsec:add_discrimination}}

When searching for a high-mass resonance through the $\Mggjjk$ spectrum, the spectra not under
consideration, namely the $\Mgg$ and $\Mjj$ spectra, add discrimination as the double Higgs
signal produces resonances on both corresponding to the decays $\Hgg$ and $\Hbb$. In both
the medium and high-purity categories,
the requirements $\Mgg \in [120, 130]$~GeV and $\Mjj \in [90, 165]$~GeV
are imposed.
These ranges were found through optimization of the expected sensitivity with the data control sample.

In the search for a low-mass resonance through the $\Mgg$ spectrum, the $\Mjj$ and $\Mggjj$ spectra
provide additional discrimination through a similar optimization. The requirement imposed
on the $\Mjj$ spectrum is the same for all resonance hypotheses, $\Mjj \in [85,155]$~GeV, while the
requirement on the $\Mggjj$ spectrum varies with respect to the resonance mass hypothesis
under consideration.
Table~\ref{table:lowmasscuts} shows how the $\Mggjj$ mass window shifts with resonance mass hypothesis.
In general the requirement is a small window about the $m_X$ under consideration.

\begin{table}[htbp!]
  \centering
  \renewcommand{\arraystretch}{1.4}
  \caption{$\Mggjj$ and $\Mjj$ requirements imposed in addition to the preselection in order to extract
the signal on the range $m_X \in [260, 400]$~GeV.}
  \input{tables/lowmasscuts}
  \label{table:lowmasscuts}
\end{table}

For the SM nonresonant signal, excess is sought on the $\Mgg \times \Mjj$ plane with a
loose selection on the dijet mass of $\Mjj \in [60, 180]$~GeV.
Additional requirements are imposed on $\Mggjjk$ and $\acosthetastar$. For the former, the signal
exhibits no narrow resonance but rather a fairly wide peaking structure about 400 GeV, as shown in
Figure~\ref{fig:ggHH_4body}. It is important
to note that the shape of this distribution varies widely among nonresonant scenarios based on
the amount of interference between the box and tree diagrams in Figure~\ref{fig:diHiggs_diagrams}.
The optimal requirement for the SM nonresonant search is $\Mggjjk > 350$~GeV for both categories.
For the sake of considering a range of scenarios, this requirement is rather implemented as a border
between event categories, where both the high and medium purity categories are themselves divided into
high-$\Mggjjk$ and low-$\Mggjjk$ subcategories.
The optimal range on $\acosthetastar$ is found to be category dependent, where the selection imposed
is $\acosthetastar < 0.90$ ($\acosthetastar < 0.65$) in the high-purity (medium-purity) category.
Table~\ref{table:nonres_addcuts} summarizes these requirements for the nonresonant search.

\begin{figure}[htbp!]
 \begin{center}
   \includegraphics[width=0.6\textwidth]{figures/selection/ggHH_4body.pdf}
 \end{center}
\caption{Simulated distribution in the $\Mggjj$ spectrum for the SM nonresonant signal.}
\label{fig:ggHH_4body}
\end{figure}


\begin{table}[htbp!]
  \centering
  \renewcommand{\arraystretch}{1.4}
  \caption{Additional discrimination for the nonresonant search beyond the preselection requirements
in Table~\ref{table:gencut}. Four event categories are formed from the number of b-tags and value of
$\Mggjjk$.}
  \input{tables/nonres_addcuts}
  \label{table:nonres_addcuts}
\end{table}

\section{Event Displays\label{sec:displays}}

Figures~\ref{fig:display_lowmass} and \ref{fig:display_highmass} show event displays of two events
passing the identification and selection requirements for the resonant search at 300 GeV and the
high-mass resonant search, respectively. These displays show the reconstructed tracks and calorimeter
deposits. As the photon showers are much narrower, one ECAL cell contains more energy
than the maximum HCAL unit corresponding to a jet, whose showers tend to be more uniform inside
the jet cone. The transverse plane is shown to highlight the secondary vertices corresponding to
the decay of a B meson inside a b-jet.

\begin{figure}[htbp!]
 \begin{center}
   \includegraphics[width=0.9\textwidth]{figures/selection/display_evt300.pdf}
 \end{center}
\caption{Event display for an event selected in the low-mass resonant search at 300 GeV.}
\label{fig:display_lowmass}
\end{figure}

\begin{figure}[htbp!]
 \begin{center}
   \includegraphics[width=0.9\textwidth]{figures/selection/display_evtHighMass.pdf}
 \end{center}
\caption{Event display for an event selected in the high-mass resonant search.}
\label{fig:display_highmass}
\end{figure}

